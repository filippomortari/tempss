{% extends "base" %}

{% block style %}
<link rel="stylesheet" href="../assets/css/tree-style.css" media="all" />
{% endblock style %}

{% block content %}

	<div class="row">
		<div class="col-md-12">
			<div class="well">
				<h3 style="padding-bottom: 20px;">Templates</h3>
				<form class="form-horizontal">
				  <div class="form-group">
				    <label for="template-select" class="col-sm-2 control-label">Available templates:</label>
				    <div class="col-sm-8">
				      <select class="form-control" id="template-select">
					    <option value="NONE">Select a template...</option>
					  </select>
				    </div>
				    <div class="col-sm-2 loading" id="template-loading" style="display:none;">
				      <img src="../assets/img/loading.gif"/>
				      <span>Loading template list...</span>
				    </div>
				  </div>
			    </form>
			</div>
		</div>	
	</div>

	<div class="row">
		<div class="col-md-3" id="profile-list">
			<div class="well">
				<h4>Profiles:</h4>
			    <div id="profiles">
			        <h6 class="infotext">Profiles for the currently selected template will appear here.</h6>
			    </div>
			</div>
		</div>
		
		<div class="col-md-9" id="template-tree">
			<div class="row">
				<div class="col-md-12">
					<div class="well" style="padding-bottom: 50px;">
						<div class="loading" id="template-tree-loading" style="display: none; float: right;">
				      	  <img src="../assets/img/loading.gif"/>
				      	  <span>Loading template tree...</span>
				    	</div>
					    <h4>Template:</h4>
					    <div id="template-container">
					    	<h6 class="infotext">No template selected. Please select a template from the drop-down list above.</h6>
					    </div>
					    <div style="float: right; padding-bottom: 30px;">
					    	<button class="btn btn-danger" id="clear-profile-btn">Clear template content</button>
					        <button class="btn btn-success" id="save-as-profile-btn">Save as profile</button>
					    </div>
					</div>
				</div>
			</div>
		</div>	
	</div>
			

{% endblock content %}

{% block modals %}

<div id="save-profile-modal" class="modal fade">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title">Save profile</h4>
      </div>
      <div class="modal-body">
        <form class="form-horizonal" role="form" style="padding-bottom: 60px;">
		  <div id="save-profile-group" class="form-group">
		    <label for="profileName" class="col-sm-3 control-label">Profile name</label>
		    <div class="col-sm-8">
		    	<input type="text" class="form-control" id="profileName" placeholder="Enter a profile name">
		    </div>
		  </div>
		  <div class="form-group">
		  	<div id="profile-save-errors" class="col-sm-offset-3 col-sm-8"><h6> </h6></div>
		  </div>
		</form> 
      </div>
      <div class="modal-footer">
      	<div id="delete-profile-modal-errors"></div>
        <button type="button" id="cancel-btn-modal" class="btn btn-danger" data-dismiss="modal">Cancel</button>
        <button id="delete-btn-modal" type="button" class="btn btn-success">Save</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

	
{% endblock modals %}

{% block script %}
<script type="text/javascript" src="../assets/js/bootstrap-tree.js"></script>
<script type="text/javascript" src="../assets/js/libhpc-parameter-tree.js"></script>
<script type="text/javascript">
	$(document).ready( function() {
		log("Document ready...")
		
		updateTemplateList();
		disableProfileButtons(true);
		
		$('#template-select').on('change', function(e) {
			var target = e.currentTarget;
			var selected = $(target).find(":selected");
			var selectedText = selected.text();
			var selectedValue = selected.val();
			setTimeout(function() {
				templateChanged(selectedValue, selectedText);
			}, 0);
		})
		
		// When the "Save as profile" button is clicked below a
		// tempalte that has had values entered into it, open 
		// the save profile modal to prompt the user for a profile name
		$('#save-as-profile-btn').on('click', function(e) {
			$('#save-profile-modal').modal();
		});
		
		// When the save profile button is clicked, open a modal
		// prompting the user to enter a profile name
		$('#save-profile-btn').on('click', function(e) {
			
		});
	});
</script>
{% endblock script %}