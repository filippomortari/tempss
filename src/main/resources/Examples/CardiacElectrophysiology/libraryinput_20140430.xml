<?xml version="1.0" encoding="UTF-8"?>
<CardiacElectrophysiology>
    <Physics>
        <Model>
            <Monodomain>
                <Chi>140</Chi>
                <Cm>0.01</Cm>
                <IsotropicConductivity>
                    <Conductivity>0.13341</Conductivity>
                </IsotropicConductivity>
            </Monodomain>
        </Model>
        <CellModel>
            <CellModelType>
                <CourtemancheRamirezNattel98>
                    <CellModelVariant>Original</CellModelVariant>
                </CourtemancheRamirezNattel98>
            </CellModelType>
            <SubSteps>4</SubSteps>
        </CellModel>
    </Physics>
    <ProblemSpecification>
        <Geometry>geometry.xml</Geometry>
        <InitialConditions>
            <Constant>-81</Constant>
        </InitialConditions>
        <Stimuli>
            <Stimulus>
                <StimulusType>
                    <StimulusCircle>
                        <p_strength>50.0</p_strength>
                        <p_x1>-15.24</p_x1>
                        <p_y1>14.02</p_y1>
                        <p_z1>6.87</p_z1>
                        <p_r1>3.0</p_r1>
                        <p_is>1.0</p_is>
                    </StimulusCircle>
                </StimulusType>
                <Protocol>
                    <ProtocolS1S2>
                        <Start>0.0</Start>
                        <Duration>2.0</Duration>
                        <S1CycleLength>300.0</S1CycleLength>
                        <Num_S1>2</Num_S1>
                        <S2CycleLength>100.0</S2CycleLength>
                    </ProtocolS1S2>
                </Protocol>
            </Stimulus>
        </Stimuli>
        <Expansion>
            <PolynomialOrder>7</PolynomialOrder>
            <BasisType>MODIFIED</BasisType>
        </Expansion>
        <FinalTime>300</FinalTime>
        <TimeStep>0.02</TimeStep>
    </ProblemSpecification>
    <NumericalAlgorithm>
        <Projection>ContinuousGalerkin</Projection>
        <TimeIntegration>
            <TimeIntegrationMethod>IMEXOrder1</TimeIntegrationMethod>
            <DiffusionAdvancement>Implicit</DiffusionAdvancement>
        </TimeIntegration>
        <MatrixInversion>
            <Iterative>
                <SubStructuring>StaticCondensation</SubStructuring>
                <Preconditioner>Diagonal</Preconditioner>
                <SuccessiveRHS>true</SuccessiveRHS>
                <IterativeSolverTolerance>1e-05</IterativeSolverTolerance>
            </Iterative>
        </MatrixInversion>
        <GlobalOptimizationParameters>
            <BackwardTransform>
                <ElementalEvaluation>
                    <Triangles>LocalMatrix</Triangles>
                    <Quadrilaterals>LocalMatrix</Quadrilaterals>
                </ElementalEvaluation>
            </BackwardTransform>
            <InnerProductWRTBase>
                <ElementalEvaluation>
                    <Triangles>LocalMatrix</Triangles>
                    <Quadrilaterals>LocalMatrix</Quadrilaterals>
                </ElementalEvaluation>
            </InnerProductWRTBase>
            <MassMatrixOp>
                <ElementalEvaluation>
                    <Triangles>SumFactorization</Triangles>
                    <Quadrilaterals>SumFactorization</Quadrilaterals>
                </ElementalEvaluation>
            </MassMatrixOp>
            <HelmholtzMatrixOp>
                <ElementalEvaluation>
                    <Triangles>SumFactorization</Triangles>
                    <Quadrilaterals>SumFactorization</Quadrilaterals>
                </ElementalEvaluation>
            </HelmholtzMatrixOp>
        </GlobalOptimizationParameters>
    </NumericalAlgorithm>
    <Admin>
        <IO_CheckSteps>50</IO_CheckSteps>
        <IO_InfoSteps>1</IO_InfoSteps>
    </Admin>
</CardiacElectrophysiology>
